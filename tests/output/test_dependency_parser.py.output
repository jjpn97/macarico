
# make sure dependency parser ref is one-step optimal

passed!
passed!

# testing on wsj

number non-projective trees: 0
# example 0  passed!
# example 1  passed!
# example 2  passed!
# example 3  passed!
# example 4  passed!
# example 5  passed!
# example 6  passed!
# example 7  passed!
# example 8  passed!
# example 9  passed!

# test dependency structure without learning
## test random policy
### rels=no
0->2 1->0 2->3 3->4 4->5
### rels=yes
0->3[2] 1->0[0] 2->3[3] 3->5[3] 4->5[0]
## test rels=no
## test rels=yes

# test simple branching trees, use_aggrevate=False
sq_err     | tr_lal      de_lal             N  epoch  rand_dev_truth          rand_dev_pred
.11.024834  | 4.000000    4.000000           1      1  [[5, 5, 5, 5, 5]     ]  [0->1 1->2 2->3 3->..]  *
.11.006996  | 4.000000    4.000000           2      1  [[5, 5, 5, 5, 5]     ]  [0->1 1->2 2->3 3->..]
..10.525623  | 4.000000    4.000000           4      1  [[5, 5, 5, 5, 5]     ]  [0->1 1->2 2->3 3->..]
....9.513557   | 4.000000    4.000000           8      1  [[5, 5, 5, 5, 5]     ]  [0->1 1->3 2->3 3->..]
..8.947797   | 4.000000    4.000000          10      1  [[5, 5, 5, 5, 5]     ]  [0->2 1->2 2->4 3->..]
..........6.270696   | 0.000000    0.000000          20      2  [[5, 5, 5, 5, 5]     ]  [0->5 1->5 2->5 3->..]  *

# test simple branching trees, use_aggrevate=True
sq_err     | tr_lal      de_lal             N  epoch  rand_dev_truth          rand_dev_pred
.0.000000   | 1.100000    1.300000           1      1  [[5, 5, 5, 5, 5]     ]  [0->1 1->5 2->5 3->..]  *
.0.000000   | 0.500000    0.800000           2      1  [[5, 5, 5, 5, 5]     ]  [0->5 1->0 2->5 3->..]  *
..0.000000   | 0.100000    0.100000           4      1  [[5, 5, 5, 5, 5]     ]  [0->5 1->5 2->5 3->..]  *
....0.000000   | 0.000000    0.000000           8      1  [[5, 5, 5, 5, 5]     ]  [0->5 1->5 2->5 3->..]  *
..0.000000   | 0.000000    0.000000          10      1  [[5, 5, 5, 5, 5]     ]  [0->5 1->5 2->5 3->..]
..........0.000000   | 0.000000    0.000000          20      2  [[5, 5, 5, 5, 5]     ]  [0->5 1->5 2->5 3->..]

# Testing wsj parser, labeled=False, use_pos_stream=False, load_embeddings=None
|word vocab| = 55, |pos vocab| = 41, n_actions = 3
reference loss on train = 0.22
sq_err     | tr_lal      de_lal             N  epoch  rand_dev_truth          rand_dev_pred
.0.000000   | 20.220000   23.940000          1      1  [[1, 2, 23, 4, 21, ..]  [0->23 1->0 2->1 3-..]  *
.........................0.000000   | 20.240000   23.940000         26      1  [[5, 5, 4, 4, 5, 58..]  [0->58 1->0 2->1 3-..]
........................0.000000   | 20.360000   23.960000         50      1  [[2, 2, 3, 28, 3, 3..]  [0->28 1->0 2->1 3-..]
.........................0.000000   | 20.360000   23.960000         75      2  [[2, 2, 3, 24, 5, 3..]  [0->24 1->0 2->1 3-..]
.........................0.000000   | 20.320000   23.960000        100      2  [[1, 2, 11, 2, 9, 9..]  [0->11 1->0 2->1 3-..]
.........................0.000000   | 20.040000   23.780000        125      3  [[3, 3, 3, 4, 14, 4..]  [0->44 1->0 2->1 3-..]  *
.........................0.000000   | 18.920000   22.840000        150      3  [[1, 4, 1, 1]        ]  [0->4 1->0 2->1 3->2 ]  *
.........................0.000000   | 17.600000   22.260000        175      4  [[3, 2, 3, 17, 3, 6..]  [0->17 1->0 2->1 3-..]  *
.........................0.000000   | 18.020000   23.240000        200      4  [[1, 9, 1, 5, 5, 2,..]  [0->34 1->0 2->1 3-..]

# Testing wsj parser, labeled=False, use_pos_stream=True, load_embeddings=None
|word vocab| = 55, |pos vocab| = 41, n_actions = 3
reference loss on train = 0.22
sq_err     | tr_lal      de_lal             N  epoch  rand_dev_truth          rand_dev_pred
.0.000000   | 20.440000   23.320000          1      1  [[3, 3, 3, 4, 14, 4..]  [0->1 1->2 2->3 3->..]  *
.........................0.000000   | 22.480000   26.460000         26      1  [[5, 2, 5, 5, 5, 25..]  [0->25 1->25 2->25 ..]
........................0.000000   | 19.820000   23.980000         50      1  [[3, 2, 3, 17, 3, 6..]  [0->17 1->0 2->1 3-..]
.........................0.000000   | 20.060000   23.960000         75      2  [[1, 2, 11, 2, 9, 9..]  [0->11 1->0 2->1 3-..]
.........................0.000000   | 19.000000   23.780000        100      2  [[2, 2, 23, 2, 6, 6..]  [0->23 1->0 2->1 3-..]
.........................0.000000   | 18.300000   22.580000        125      3  [[2, 2, 20, 6, 6, 6..]  [0->20 1->0 2->1 3-..]  *
.........................0.000000   | 17.740000   22.780000        150      3  [[2, 2, 11, 11, 5, ..]  [0->29 1->0 2->1 3-..]
.........................0.000000   | 17.040000   21.000000        175      4  [[8, 29, 4, 4, 5, 1..]  [0->29 1->0 2->3 3-..]  *
.........................0.000000   | 17.800000   22.480000        200      4  [[1, 2, 11, 2, 9, 9..]  [0->11 1->0 2->1 3-..]

# Testing wsj parser, labeled=True, use_pos_stream=False, load_embeddings=None
|word vocab| = 55, |pos vocab| = 41, n_actions = 15
reference loss on train = 0.22
sq_err     | tr_lal      de_lal             N  epoch  rand_dev_truth          rand_dev_pred
.0.000000   | 24.200000   27.520000          1      1  [[1, 2, 11, 2, 9, 9..]  [0->1[4] 1->2[11] 2..]  *
.........................0.000000   | 24.220000   27.600000         26      1  [[8, 8, 3, 8, 3, 6,..]  [0->8[7] 1->8[7] 2-..]
........................0.000000   | 24.000000   27.340000         50      1  [[2, 2, 3, 39, 3, 7..]  [0->39[1] 1->0[1] 2..]  *
.........................0.000000   | 24.020000   27.400000         75      2  [[1, 12, 4, 4, 1, 6..]  [0->43[1] 1->0[1] 2..]
.........................0.000000   | 24.000000   27.340000        100      2  [[2, 2, 3, 28, 3, 3..]  [0->28[1] 1->0[1] 2..]
.........................0.000000   | 23.980000   27.340000        125      3  [[2, 2, 15, 2, 6, 6..]  [0->21[1] 1->0[1] 2..]
.........................0.000000   | 24.000000   27.360000        150      3  [[2, 2, 8, 2, 7, 7,..]  [0->46[1] 1->0[1] 2..]
.........................0.000000   | 23.980000   27.340000        175      4  [[1, 5, 1, 4, 2, 33..]  [0->32[1] 1->0[1] 2..]
.........................0.000000   | 23.940000   27.340000        200      4  [[15, 15, 3, 15, 5,..]  [0->41[1] 1->0[1] 2..]

# Testing wsj parser, labeled=True, use_pos_stream=True, load_embeddings=None
|word vocab| = 55, |pos vocab| = 41, n_actions = 15
reference loss on train = 0.22
sq_err     | tr_lal      de_lal             N  epoch  rand_dev_truth          rand_dev_pred
.0.000000   | 25.120000   28.440000          1      1  [[6, 2, 6, 4, 2, 6]  ]  [0->6[2] 1->2[2] 2-..]  *
.........................0.000000   | 24.560000   27.980000         26      1  [[1, 9, 1, 5, 5, 2,..]  [0->34[2] 1->34[2] ..]  *
........................0.000000   | 23.980000   27.340000         50      1  [[1, 3, 3, 53, 5, 3..]  [0->53[1] 1->0[1] 2..]  *
.........................0.000000   | 23.980000   27.340000         75      2  [[2, 2, 20, 6, 6, 6..]  [0->20[1] 1->0[1] 2..]
.........................0.000000   | 23.980000   27.340000        100      2  [[1, 2, 21, 5, 5, 2..]  [0->29[1] 1->0[1] 2..]
.........................0.000000   | 23.960000   27.340000        125      3  [[1, 36, 1, 5, 5, 1..]  [0->36[1] 1->0[1] 2..]
.........................0.000000   | 23.560000   27.360000        150      3  [[2, 2, 3, 24, 5, 3..]  [0->23[1] 1->0[1] 2..]
.........................0.000000   | 23.760000   27.300000        175      4  [[1, 4, 1, 1]        ]  [0->4[1] 1->0[1] 2-..]  *
.........................0.000000   | 22.780000   27.120000        200      4  [[1, 2, 46, 4, 2, 2..]  [0->46[1] 1->0[1] 2..]  *
